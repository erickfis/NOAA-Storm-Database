---
title: "Bad caption behavior"
author: "erickfis"
date: "`r format(Sys.time(), '%Y %B, %d')`"
header-includes:
   - \usepackage{lipsum}



output:

        pdf_document:
                toc: true
                toc_depth: 3
                number_sections: true
                keep_tex: yes


---


```{r knit-rules, echo=FALSE}
library(knitr)

opts_chunk$set(echo = FALSE, message = FALSE, include = TRUE, 
               warning = FALSE, autodep = TRUE, options(scipen=999),
               fig.pos = "H")

```


```{r libraries}

library(scales)
library(stringr)
library(data.table)
library(chron)
library(dplyr)
library(lubridate)
library(ggplot2)
library(rmarkdown)
library(RColorBrewer)
library(gridExtra)
library(grid)
library(pander)

```

# All Cars


Table 1 should be here:

```{r table 1}
dados <- tbl_df(mtcars)

kable(mtcars, caption = "All cars")
```

## randow text

\lipsum


# Now a plot

Plot 1 should be here


```{r plot1, cache=TRUE, fig.cap="HP vs mpg - plot"}

dados$cyl <- factor(dados$cyl)

plot1 <- ggplot(dados, aes(hp, mpg, color=cyl))

plot1 <- plot1 + geom_point() + labs(title="HP vs mpg - 1st plot")

plot1 

  
```

## randow text

\lipsum


## Now a table

\lipsum

Table should come here

```{r table 2}

kable(mtcars[,1:3], caption = "All cars, 3 vars")
```


# Now another plot

Plot  should be here

```{r plot2, cache=TRUE, fig.cap="disp vs mpg - plot"}


plot2 <- ggplot(dados, aes(disp, mpg, color=cyl))

plot2 <- plot2 + geom_point() + labs(title="disp vs mpg - 2st plot")

plot2 

  
```
## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

## Now a table

Table should come here
```{r}

kable(mtcars[1:10,2:5], caption = "10 first cars")

```

\lipsum

# Now a table

\lipsum


Table should come here
```{r}
kable(mtcars[,3:8], caption = "another one cars")
```

# Now a plot

\lipsum


Plot  should be here


```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```

# Now a table

\lipsum



Table should come here
```{r}
kable(mtcars[,4:8], caption = "another one")
```

# Now a grid


```{r fig.width=10, fig.height=10, fig.cap="grid 2"}

grid.arrange(plot1, plot2, plot2, plot1, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```

## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```

## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

## Now a table

Table should come here
```{r}

kable(mtcars[1:10,2:5], caption = "10 first cars")

```

\lipsum

# Now a table

\lipsum


Table should come here
```{r}
kable(mtcars[,3:8], caption = "another one cars")
```

# Now a plot

\lipsum


Plot  should be here


```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```

# Now a table

\lipsum



Table should come here
```{r}
kable(mtcars[,4:8], caption = "another one")
```

# Now a grid


```{r fig.width=10, fig.height=10, fig.cap="grid 2"}

grid.arrange(plot1, plot2, plot2, plot1, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```

## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```


## randow text

\lipsum


# A grid 

```{r fig.width=10, fig.height=10, fig.cap="grid 1"}

grid.arrange(plot2, plot1, plot1, plot2, 
             nrow=2, ncol=2)
grid.rect(gp=gpar(fill=NA))
```



## randow text

\lipsum

Table should come here

```{r}

kable(mtcars[,1:6], caption = "All cars, 6 vars")
```

```{r cache=TRUE, fig.cap="disp vs mpg - plot"}
plot2
```







